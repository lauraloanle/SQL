# link: https://leetcode.com/problems/highest-grade-for-each-student/


# Oracle using Windown function solution: 

SELECT TEMP.STUDENT_ID, TEMP.COURSE_ID, TEMP.GRADE
FROM
(SELECT STUDENT_ID, COURSE_ID, GRADE, 
       ROW_NUMBER() OVER(PARTITION BY STUDENT_ID 
       ORDER BY GRADE DESC, COURSE_ID ASC) AS RANK
FROM ENROLLMENTS) TEMP
WHERE TEMP.RANK = 1
ORDER BY TEMP.STUDENT_ID;

#MySQL solution:

SELECT STUDENT_ID, MIN(COURSE_ID) AS COURSE_ID, GRADE
FROM ENROLLMENTS
WHERE (STUDENT_ID, GRADE) IN
(SELECT STUDENT_ID, MAX(GRADE) AS GRADE FROM ENROLLMENTS GROUP BY STUDENT_ID)
GROUP BY STUDENT_ID
ORDER BY STUDENT_ID;